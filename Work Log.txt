TO DO:
- Clean up code (add comments and correct indentation)